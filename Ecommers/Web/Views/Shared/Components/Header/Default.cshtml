@model Ecommers.Web.Models.Shared.Components.HeaderViewModel
@{
    var basePath = Context.Request.PathBase;
    var baseUrl = $"{Context.Request.Scheme}://{Context.Request.Host}{Context.Request.PathBase}";
}
<header class="sticky top-0 bg-white/90 backdrop-blur-md border-b border-gray-200 shadow-sm z-50">
    <div class="container mx-auto px-3 sm:px-6 lg:px-8 flex justify-between items-center py-3 sm:py-4">

        <!-- Logo -->
        <div class="flex items-center gap-2 sm:gap-3">
            <div class="rounded-full p-1.5 sm:p-2 bg-gradient-to-br from-yellow-700 to-yellow-500 text-white">
                <a href="/">
                    <img src="@Model.ConfiguracionesD.Logo" class="w-8 h-8 sm:w-10 sm:h-10" alt="Logo" />
                </a>
            </div>
            <span class="font-bold text-base sm:text-xl text-gray-800 hidden xs:inline">@Model.ConfiguracionesD.AbreviacionEmpresa</span>
            <span class="font-bold text-base text-gray-800 xs:hidden">@Model.ConfiguracionesD.MetaAutor</span>
        </div>

        <!-- Botones -->
        <div class="flex items-center gap-2 sm:gap-3">

            <!-- Buscar -->
            <div class="relative">
                <button id="btnSearch" class="text-gray-700 text-xl sm:text-2xl p-2 hover:bg-gray-100 rounded-full transition">
                    <i class="fas fa-search"></i>
                </button>

                <!-- Input search desktop -->
                <input id="searchInput"
                       type="text"
                       placeholder="Buscar productos..."
                       class="transition-all duration-200 ease-in-out hidden md:block absolute right-0 top-0 mt-12 w-64 md:w-80 px-4 rounded-lg
                      bg-white/95 text-gray-800 border-2 border-transparent shadow-lg
                      focus:outline-none focus:border-yellow-400 focus:ring-2 focus:ring-yellow-400
                      focus:ring-opacity-50 z-10 h-0 py-0 opacity-0 scale-95 overflow-hidden" />
            </div>

            <!-- Usuario -->
            <div class="relative">
                <button id="btnUser" class="text-gray-700 text-xl sm:text-2xl p-2 hover:bg-gray-100 rounded-full transition">
                    <i class="fas fa-user"></i>
                </button>
                <div id="userMenu"
                     class="transition-all duration-200 ease-in-out hidden absolute right-0 mt-2 w-64 bg-white border border-gray-200 rounded-xl shadow-lg z-50 overflow-hidden opacity-0 scale-95 max-h-0">

                    <!-- Dropdown usuario -->
                    @if (Model.LoggedUser != null)
                    {
                        <div class="flex items-center gap-3 mb-4 pb-3 border-b border-gray-100">
                            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&w=64&q=80"
                                 alt="Avatar" class="w-12 h-12 rounded-full object-cover w-12 h-12 rounded-full object-cover m-2.5">
                            <div>
                                <p class="font-semibold text-gray-800">@Model.LoggedUser.FirstName</p>
                                <p class="text-sm text-gray-500">@Model.LoggedUser.Email</p>
                            </div>
                          
                        </div>
                        <div class="space-y-2">
                            @if (Model.LoggedUser?.IsAdmin == true)
                            {
                                <a href="/Dashboard"
                                   class="flex items-center gap-2 w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 transition text-gray-700">
                                    <i class="fas fa-store"></i> <!-- Icono de tienda -->
                                    Administrar tienda
                                </a>
                            }
                            <a href="/perfil"
                               class="flex items-center gap-2 w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 transition text-gray-700">
                                <i class="fas fa-user text-sm"></i>
                                Mi Perfil
                            </a>
                            <a href="/pedidos"
                               class="flex items-center gap-2 w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 transition text-gray-700">
                                <i class="fas fa-box text-sm"></i>
                                Mis Pedidos
                            </a>
                            <a href="/favoritos"
                               class="flex items-center gap-2 w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 transition text-gray-700">
                                <i class="fas fa-heart text-sm"></i>
                                Favoritos
                            </a>
                            <a href="/Auth/Logout"
                               class="flex items-center gap-2 w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 transition text-red-600">
                                <i class="fas fa-sign-out-alt text-sm"></i>
                                Cerrar Sesión
                            </a>
                        </div>
                    }
                    else
                    {
                        <div class="p-4 text-center">
                            <i class="fas fa-user-circle text-4xl text-gray-400 mb-2"></i>
                            <p class="text-gray-600 text-sm">¡Inicia sesión para acceder a tu cuenta!</p>
                            <div class="mt-4 space-y-2">
                                <a href="/Auth/Login" class="w-full block bg-yellow-400 text-white px-4 py-2 rounded-lg hover:bg-yellow-500 transition">Iniciar Sesión</a>
                                <a href="/Auth/Register" class="w-full block bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition">Registrarse</a>
                            </div>
                        </div>
                    }
                </div>
                
                
                
            </div>

            <!-- Carrito -->
            <div class="relative">
                <button id="btnCart" class="relative text-gray-700 text-xl sm:text-2xl p-2 hover:bg-gray-100 rounded-full transition">
                    <i class="fas fa-shopping-cart"></i>
                    <span id="cartCounter"
                          class="hidden absolute top-0 right-0 bg-red-500 text-white text-xs rounded-full px-1.5 min-w-[20px] h-5 flex items-center justify-center font-semibold">
                        0
                    </span>
                </button>

                <!-- Carrito dropdown - Desktop (sm y superiores) -->
                <div id="cartMenu"
                     class="transition-all duration-300 ease-in-out hidden sm:block absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-xl shadow-lg z-50 overflow-hidden flex-col opacity-0 scale-95 max-h-0">

                    <div id="cartList" class="overflow-y-auto flex-1 p-4 text-gray-600 text-center max-h-96">
                        <p class="py-10">Tu carrito está vacío</p>
                    </div>

                    <div id="cartFooter" class="hidden px-4 py-3 border-t border-gray-100 bg-gray-50 flex justify-between items-center">
                        <p class="font-bold">Total: <span id="cartTotal">$0</span></p>
                        <a class="bg-yellow-400 text-white px-4 py-2 rounded-lg font-semibold hover:bg-yellow-500 transition"
                           href="/carrito">
                            Pagar
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Input Search móvil -->
    <div id="searchMobile" class="transition-all duration-200 ease-in-out hidden md:hidden px-3 max-h-0 overflow-hidden opacity-0">
        <input id="mobileSearchInput"
               type="text"
               placeholder="Buscar productos..."
               class="w-full px-4 py-2 rounded-lg bg-white text-gray-800 border-2 border-gray-200
                  focus:outline-none focus:border-yellow-400 focus:ring-2 focus:ring-yellow-400
                  focus:ring-opacity-50 transition-all mb-3" />
    </div>

</header>

<!-- Overlay para móvil (fuera del header) -->
<div id="cartOverlay"
     class="fixed inset-0 bg-black/50 z-[60] hidden opacity-0 transition-opacity duration-300 sm:hidden">
</div>

<!-- Carrito Modal - Móvil (Bottom Sheet) -->
<div id="cartModalMobile"
     class="fixed bottom-0 left-0 right-0 bg-white rounded-t-3xl shadow-2xl z-[70] transform translate-y-full transition-transform duration-300 sm:hidden max-h-[80vh] flex flex-col">

    <!-- Handle para arrastrar -->
    <div class="w-full flex justify-center pt-3 pb-2">
        <div class="w-12 h-1.5 bg-gray-300 rounded-full"></div>
    </div>

    <!-- Header del modal -->
    <div class="flex justify-between items-center px-4 py-3 border-b border-gray-200">
        <h3 class="text-lg font-bold text-gray-800">
            <i class="fas fa-shopping-cart text-yellow-500 mr-2"></i>
            Mi Carrito
        </h3>
        <button id="closeCartMobile" class="text-gray-500 hover:text-gray-700 text-2xl transition">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- Lista de productos -->
    <div id="cartListMobile" class="overflow-y-auto flex-1 p-4 text-gray-600 text-center">
        <p class="py-10">Tu carrito está vacío</p>
    </div>

    <!-- Footer del modal -->
    <div id="cartFooterMobile" class="hidden px-4 py-4 border-t border-gray-100 bg-gray-50">
        <div class="flex justify-between items-center mb-3">
            <p class="font-bold text-lg text-gray-700">Total:</p>
            <p class="font-bold text-xl text-yellow-600" id="cartTotalMobile">$0</p>
        </div>
        <a class="w-full block text-center bg-yellow-400 text-white px-4 py-3 rounded-lg font-semibold hover:bg-yellow-500 transition shadow-md"
           href="/carrito">
            <i class="fas fa-credit-card mr-2"></i>
            Ir a Pagar
        </a>
    </div>
</div>